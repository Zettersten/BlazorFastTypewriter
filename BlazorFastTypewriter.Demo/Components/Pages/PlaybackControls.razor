@page "/playback"
@using BlazorFastTypewriter

<PageTitle>Playback Controls - BlazorFastTypewriter</PageTitle>

<div class="page-header">
    <h1>Playback Controls</h1>
    <p class="page-subtitle">Full programmatic control over animations</p>
</div>

<section class="demo-section">
    <h2>Interactive Playback</h2>
    <p>Full programmatic control over the animation with Start, Pause, Resume, Complete, and Reset methods.</p>
    
    <div class="player-container">
        <TypewriterControls 
            Overlay="false"
            IsRunning="_controlRunning"
            IsPaused="_controlPaused"
            Progress="_controlProgress"
            ShowProgress="true"
            ShowPlayPause="true"
            ShowReset="true"
            ShowStop="true"
            ShowSkipEnd="true"
            CanPlay="!_controlRunning"
            CanPause="_controlRunning && !_controlPaused"
            CanResume="_controlPaused"
            CanStop="_controlRunning"
            CanSkipEnd="_controlRunning"
            CanReset="true"
            OnPlayClick="StartControl"
            OnPauseClick="PauseControl"
            OnResumeClick="ResumeControl"
            OnStopClick="ResetControl"
            OnSkipEndClick="CompleteControl"
            OnResetClick="ResetControl" />
        
        <div class="demo-preview">
            <Typewriter @ref="_controlTypewriter"
                        Autostart="false"
                        Speed="70"
                        OnStart="HandleControlStart"
                        OnPause="HandleControlPause"
                        OnResume="HandleControlResume"
                        OnComplete="HandleControlComplete"
                        OnProgress="HandleControlProgress">
                <div>
                    <h3>Interactive Controls Demo</h3>
                    <p>Use the player controls above to control the animation. You can play, pause, resume, skip to end, or reset.</p>
                    <p>Status: <strong>@_controlStatus</strong></p>
                    <p>This demonstrates all the lifecycle methods available for controlling the typewriter animation programmatically.</p>
                </div>
            </Typewriter>
        </div>
    </div>
    
    <CodeSample>
        <pre><code class="language-xml">&lt;Typewriter @@ref="_typewriter" Autostart="false"&gt;
    &lt;p&gt;Content...&lt;/p&gt;
&lt;/Typewriter&gt;

&lt;button @@onclick="Start"&gt;Start&lt;/button&gt;
&lt;button @@onclick="Pause"&gt;Pause&lt;/button&gt;
&lt;button @@onclick="Resume"&gt;Resume&lt;/button&gt;
&lt;button @@onclick="Complete"&gt;Complete&lt;/button&gt;
&lt;button @@onclick="Reset"&gt;Reset&lt;/button&gt;

@@code {
    private Typewriter? _typewriter;
    
    private async Task Start()
    {
        if (_typewriter is not null)
            await _typewriter.Start();
    }
    
    private async Task Pause() => await _typewriter?.Pause();
    
    private async Task Resume()
    {
        if (_typewriter is not null)
            await _typewriter.Resume();
    }
    
    private async Task Complete()
    {
        if (_typewriter is not null)
            await _typewriter.Complete();
    }
    
    private async Task Reset()
    {
        if (_typewriter is not null)
            await _typewriter.Reset();
    }
}</code></pre>
    </CodeSample>
</section>

<section class="demo-section">
    <h2>Progress Tracking</h2>
    <p>Monitor animation progress with the <code>OnProgress</code> event callback, fired every 10 characters.</p>
    
    <div class="demo-container">
        <div class="progress-display">
            <div class="progress-bar">
                <div class="progress-fill" style="width: @(_progressPercent)%"></div>
            </div>
            <div class="progress-text">
                @_progressText
            </div>
        </div>
        
        <div class="demo-preview">
            <Typewriter @ref="_progressTypewriter"
                        Autostart="false"
                        Speed="60"
                        OnProgress="HandleProgress"
                        OnComplete="HandleProgressComplete">
                <p>This example demonstrates progress tracking. Watch the progress bar and percentage update as the text types out character by character. The progress event fires every 10 characters, giving you real-time feedback on the animation state.</p>
            </Typewriter>
        </div>
        
        <div class="demo-controls">
            <button @onclick="StartProgress" disabled="@(_progressRunning)">Start</button>
            <button @onclick="ResetProgress">Reset</button>
        </div>
    </div>
    
    <CodeSample>
        <pre><code class="language-xml">&lt;Typewriter @@ref="_typewriter"
            OnProgress="HandleProgress"
            OnComplete="HandleComplete"&gt;
    &lt;p&gt;Content...&lt;/p&gt;
&lt;/Typewriter&gt;

&lt;div&gt;Progress: @@_percent% (@@_current/@@_total)&lt;/div&gt;

@@code {
    private Typewriter? _typewriter;
    private double _percent = 0;
    private int _current = 0;
    private int _total = 0;
    
    private void HandleProgress(TypewriterProgressEventArgs args)
    {
        _percent = args.Percent;
        _current = args.Current;
        _total = args.Total;
        StateHasChanged();
    }
    
    private void HandleComplete()
    {
        // Animation completed
    }
}</code></pre>
    </CodeSample>
</section>

<section class="demo-section">
    <h2>Dynamic Content Updates</h2>
    <p>Change content dynamically using the <code>SetText</code> method with either HTML strings or RenderFragment.</p>
    
    <div class="demo-container">
        <div class="demo-preview">
            <Typewriter @ref="_dynamicTypewriter"
                        Autostart="false"
                        Speed="60">
                <p>Initial content. Click the buttons below to change this text dynamically.</p>
            </Typewriter>
        </div>
        
        <div class="demo-controls">
            <button @onclick="SetText1">Set Text 1</button>
            <button @onclick="SetText2">Set Text 2</button>
            <button @onclick="SetTextHtml">Set HTML</button>
            <button @onclick="ResetDynamic">Reset</button>
        </div>
    </div>
    
    <CodeSample>
        <pre><code class="language-xml">&lt;Typewriter @@ref="_typewriter" Autostart="false"&gt;
    &lt;p&gt;Initial content...&lt;/p&gt;
&lt;/Typewriter&gt;

&lt;button @@onclick="ChangeText"&gt;Change Text&lt;/button&gt;

@@code {
    private Typewriter? _typewriter;
    
    private async Task ChangeText()
    {
        if (_typewriter is null) return;
        
        // Using HTML string
        await _typewriter.SetText("&lt;p&gt;New &lt;strong&gt;content&lt;/strong&gt; here!&lt;/p&gt;");
        
        // Start animation after setting text
        await _typewriter.Start();
    }
}</code></pre>
    </CodeSample>
</section>
